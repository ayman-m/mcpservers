[{"rule_id": 19, "name": "Arista Cloud Vision Wireless Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = arista_cloud_vision_wireless_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 31, "name": "Arista Cloud Vision Wireless_ Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = arista_cloud_vision_wireless_blackgeneric_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 53, "name": "jira-v2 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = jira_v2_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 50, "name": "Jira V3 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = jira_v3_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 36, "name": "AzureDevOps Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = azuredevops_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 27, "name": "Possible Attacks against AP/Security Cameras", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_traffic_raw \n| fields app,from_zone,source_ip,source_port,dest_ip, dest_port, to_zone, action, sub_type, dest_device_host, log_source_name, rule_matched, sub_type, log_type\n//severity, pcap_id, pcap, threat_name, file_name, url_domain, source_user_info_name, threat_category, sub_type, threat_id\n| filter incidr(dest_ip, \"10.220.10.0/24, 10.220.11.0/24\") = True\n| filter (from_zone not in (\"security_cameras\", \"noc_wifi\", \"switch-ap_mgmt\", \"TAP-FW-1\")) \n| comp count(dest_ip) as number_of_attempts by source_ip, dest_ip, dest_port, app, from_zone, to_zone, action, rule_matched, log_type\n| filter  number_of_attempts > 50 AND action != \"drop\"", "is_enabled": true, "description": null, "alert_name": "Possible Attacks against AP/Security Cameras", "alert_category": "INFILTRATION", "alert_type": null, "alert_description": "$source_ip on $from_zone has been hitting $dest_ip on the $to_zone zone with the app $app over $number_of_attempts times", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"logsource": "log_type", "action_local_ip": "source_ip", "fw_interface_to": "to_zone", "action_remote_ip": "dest_ip", "fw_interface_from": "from_zone"}, "execution_mode": "SCHEDULED", "search_window": "1 hours", "simple_schedule": "1 hour", "timezone": "America/Los_Angeles", "crontab": "0 * * * *", "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 26, "name": "IoT Security - New Raspberry Device Found", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_iot_security_devices_raw \n| filter profile contains \"Raspberry Pi Device\"\n| alter duration_time = timestamp_diff(_insert_time,first_seen_date,\"MINUTE\") \n| filter duration_time <= 30 and duration_time  >= 0\n\n//| dedup mac_address  ", "is_enabled": true, "description": "This alert is searching for a Raspberry Pi device that was just plugged in", "alert_name": "IoT Security - New Raspberry Device Found", "alert_category": "RECONNAISSANCE", "alert_type": null, "alert_description": "A new Raspberry Pi device $hostname with the IP address $ip_address on the subnet $subnet has been detected.", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["hostname"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 28, "name": "Possible Attacks against AP/Security Cameras (THREAT LOGS)", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n| fields app,from_zone,source_ip,source_port,dest_ip, dest_port, to_zone, action, sub_type, dest_device_host, log_source_name, rule_matched, sub_type, log_type, severity, pcap_id, pcap, threat_name, file_name, url_domain, source_user_info_name, threat_category, sub_type, threat_id\n| filter incidr(dest_ip, \"10.220.10.0/24, 10.220.11.0/24\") = True\n| filter (from_zone not in (\"security_cameras\", \"noc_wifi\", \"switch-ap_mgmt\", \"TAP-FW-1\")) \n| filter from_zone != \"dns\" and to_zone != \"dns\"\n//| comp count(dest_ip) as number_of_attempts by source_ip, dest_ip, dest_port, app, from_zone, to_zone, action, rule_matched, log_type\n//| filter  number_of_attempts > 50", "is_enabled": true, "description": null, "alert_name": "Possible Attacks against AP/Security Cameras (THREAT LOGS)", "alert_category": "INFILTRATION", "alert_type": null, "alert_description": "$source_ip on $from_zone has been hitting $dest_ip on the $to_zone zone with the app $app and firing the $threat_name signature", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"action_local_ip": "source_ip", "action_remote_ip": "dest_ip"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "30 minutes", "suppression_fields": ["source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 24, "name": "Interzone Class Threat Detected", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n| fields app,from_zone,source_ip,source_port,dest_ip, dest_port, to_zone, action,\n    file_sha_256, sub_type,\n    dest_device_host,\n    cloud_hostname, log_source_name,\n    rule_matched,\n    severity,\n    pcap_id,\n    pcap,\n    session_id,\n    threat_name,\n    file_name, url_domain,\n    source_user_info_name,\n    threat_category, sub_type, threat_id \n| filter rule_matched not contains \"Allow Tap\"\n| filter to_zone != \"internet\" and from_zone != \"internet\"\n| filter (rule_matched != \"\"\"RDNS Outbound DNS\"\"\") \n| filter from_zone != to_zone\n| filter app not contains \"dns\" and to_zone != \"dns\"\n| filter from_zone not contains \"noc_\" and to_zone != \"reg_web\"\n| filter rule_matched not contains \"nate_joel_laptop_to_reg\"\n| filter to_zone != \"tools_mgmt\"", "is_enabled": true, "description": "Detecting any spyware threats from classroom to classroom", "alert_name": "Interzone Class Spyware Detected", "alert_category": "LATERAL_MOVEMENT", "alert_type": null, "alert_description": "The source ip $source_ip from the classroom $from_zone is possibly attacking the classroom $to_zone.", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"threatname": "threat_name", "action_local_ip": "source_ip", "fw_interface_to": "to_zone", "action_remote_ip": "dest_ip", "fw_interface_from": "from_zone", "action_external_hostname": "file_name"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 40, "name": "Corelight AI Classroom Triage Alert", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = corelight_ai_triage_raw \n| filter IR_recommendation = \"ESCALATE\"\n| fields First_ts, Source_IP,Source_IP_range, Destination_IP, Destination_Range, alert_name, Criticality, Criticality_explanation, Source_subnet, Curriculum_question, Curriculum_explanation, IR_explanation, IR_recommendation, Traffic_direction ", "is_enabled": true, "description": "Corelight ML model has determined that the behavior from this classroom warrants investigation", "alert_name": "$alert_name", "alert_category": "OTHER", "alert_type": null, "alert_description": "The ML model determines the activity recommends that the analyst should %IR_recommendation\n$IR_explanation", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"agent_hostname": null, "action_local_ip": "Source_IP", "action_remote_ip": "Destination_IP", "action_remote_port": null, "agent_device_domain": null, "actor_effective_username": null, "actor_process_image_name": null, "actor_process_image_path": null, "actor_process_command_line": null, "actor_process_image_sha256": null}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["Source_IP"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 20, "name": "Wildfire Malware Detected", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n//| fields dest_ip, app_category, threat_*, source_ip, to_zone, from_zone, action\n|filter sub_type ~= \".*wildfire-virus.*|.*virus.*|.*wildfire.*|.*virus.*\"\n|filter verdict != \"benign\"and verdict != null\n| fields app, verdict,\n    to_zone,\n    dest_device_host as dest_hostname,\n    dest_ip, dest_port,\n    file_sha_256 as file_hash,\n    cloud_hostname, log_source_name as firewall_name,\n    action,\n    rule_matched as rule,\n    severity,\n    pcap_id as pcap_id,\n    pcap,\n    session_id,\n    from_zone,\n    source_ip as src_ip,\n    source_port as src_port,\n    threat_name as threat,\n    file_name as url_filename,\n    users \n//| iploc  src_ip loc_city, loc_region, loc_country, loc_continent, loc_latlon, loc_timezone \n//| comp count(dest_ip) as count_dest by threat_category ", "is_enabled": true, "description": "$user downloaded this file $url_filename  which is malicious using $app threat_name $threat", "alert_name": "Wildfire Malware Detected", "alert_category": "DROPPER", "alert_type": null, "alert_description": "$src_ip downloaded this file $url_filename  which is malicious using $app threat_name $threat", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"action_local_ip": "src_ip", "fw_interface_to": "to_zone", "action_file_name": "url_filename", "action_remote_ip": "dest_ip", "fw_interface_from": "from_zone", "action_file_sha256": "file_hash", "action_remote_port": "dest_port", "actor_effective_username": "users"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["src_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 22, "name": "Outbound C2 Spyware", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n| fields app,from_zone,source_ip,source_port,dest_ip, dest_port, to_zone, action,\n    file_sha_256, sub_type,\n    dest_device_host,\n    cloud_hostname, log_source_name,\n    rule_matched,\n    severity,\n    pcap_id,\n    pcap,\n    session_id,\n    threat_name,\n    file_name, url_domain,\n    source_user_info_name,\n    threat_category, sub_type, threat_id, users\n| alter threat = threat_name + \" (\" + to_string(threat_id) + \")\"\n//| filter threat_id != 14978 and threat_id != 14984\n//| filter severity != \"Informational\" and severity != \"Low\" and severity != \"Medium\" and severity != null\n| filter app not contains \"dns\"\n| filter sub_type = \"spyware\"\n| filter incidr(dest_ip, \"10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16\") = false and from_zone not in(\"internet\")\n| filter rule_matched != \"Allow TAP\"\n| filter file_name contains \".oast.\"\n//| filter to_zone = \"internet\" and from_zone != \"internet\"", "is_enabled": true, "description": null, "alert_name": "Outbound C2 Spyware - $threat_name", "alert_category": "EXECUTION", "alert_type": null, "alert_description": "$users has outbound traffic attempts to this malicious domain $file_name ($threat) in the last 24 hours.", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"threatname": "threat_name", "eventaction": "action", "action_local_ip": "source_ip", "action_remote_ip": "dest_ip", "action_local_port": "source_port", "action_remote_port": "dest_port", "action_external_hostname": "file_name", "actor_effective_username": "users"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["threat_id", "source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 12, "name": "Captive Portal Continue Click", "severity": "SEV_010_INFO", "xql_query": "dataset = panw_ngfw_url_raw \n| filter action = \"continue\"\n| fields source_user, action ", "is_enabled": true, "description": "A user has clicked on the captive portal.", "alert_name": "Captive Portal Continue Click", "alert_category": "User Defined", "alert_type": null, "alert_description": null, "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 minutes", "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": "action", "mitre_defs": {}, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 51, "name": "Generic Webhook Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = generic_webhook_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 37, "name": "GitHub Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = github_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 43, "name": "Gitlab - User Permission Changed", "severity": "SEV_030_MEDIUM", "xql_query": "datamodel dataset = gitlab_gitlab_raw \r\n| fields _time\r\n,xdm.event.id \r\n,xdm.source.user.identifier \r\n,xdm.target.resource.id \r\n,xdm.target.resource.type \r\n,xdm.source.user.username \r\n,xdm.target.resource.sub_type \r\n,xdm.target.resource.name \r\n,xdm.event.description \r\n,xdm.source.ipv4 \r\n,xdm.target.resource_before.value \r\n,xdm.target.resource.value \r\n,xdm.event.operation \r\n,xdm.event.type \r\n,xdm.event.operation_sub_type \r\n| filter xdm.event.operation = \"change_access_level\" and xdm.target.resource_before.value = \"Guest\" and xdm.target.resource.value = \"Owner\"", "is_enabled": true, "description": "Alert for change in user''s permissions change from Guest to Owner.", "alert_name": "Gitlab - User Permission Changed", "alert_category": "PRIVILEGE_ESCALATION", "alert_type": null, "alert_description": "User''s permissions have changed from Guest to Owner", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"agent_hostname": null, "action_local_ip": null, "action_remote_ip": "xdm.source.ipv4", "action_remote_port": null, "agent_device_domain": null, "actor_effective_username": "xdm.target.resource.name", "actor_process_image_name": null, "actor_process_image_path": null, "actor_process_command_line": null, "actor_process_image_sha256": null}, "execution_mode": "SCHEDULED", "search_window": "10 minutes", "simple_schedule": "10 minutes", "timezone": "America/Chicago", "crontab": "*/10 * * * *", "suppression_enabled": true, "suppression_duration": "10 minutes", "suppression_fields": ["xdm.source.user.username"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "datamodel dataset = gitlab_gitlab_raw \r\n| fields _time\r\n,xdm.event.id \r\n,xdm.source.user.identifier \r\n,xdm.target.resource.id \r\n,xdm.target.resource.type \r\n,xdm.source.user.username \r\n,xdm.target.resource.sub_type \r\n,xdm.target.resource.name \r\n,xdm.event.description \r\n,xdm.source.ipv4 \r\n,xdm.target.resource_before.value \r\n,xdm.target.resource.value \r\n,xdm.event.operation \r\n,xdm.event.type \r\n,xdm.event.operation_sub_type \r\n| filter xdm.event.operation = \"change_access_level\" and xdm.target.resource_before.value = \"Guest\" and xdm.target.resource.value = \"Owner\"", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 56, "name": "GoogleThreatIntelligenceDTMAlerts Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = googlethreatintelligencedtmalerts_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 57, "name": "GoogleThreatIntelligenceASMIssues Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = googlethreatintelligenceasmissues_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 2, "name": "HelloWorld Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = helloworld_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 32, "name": "NUC Agent Update Script", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = endpoints\r\n| filter group_names in (\"NUCs\") and last_upgrade_status = \"COMPLETED_SUCCESSFULLY\" and endpoint_status = ENUM.CONNECTED  \r\n| alter ct = current_time()\r\n| alter diff_in_mins = timestamp_diff(ct, last_upgrade_status_time, \"MINUTE\")\r\n| filter diff_in_mins < 59\r\n| fields diff_in_mins, endpoint_status, endpoint_id, endpoint_name, group_names, agent_version, ip_address , mac_address, last_upgrade_status_time ", "is_enabled": true, "description": "An alert to verify the upgrade status", "alert_name": "NUC Agent Update Script", "alert_category": "OTHER", "alert_type": null, "alert_description": "NUC endpoints that require to execute update script", "alert_domain": "DOMAIN_IT", "alert_fields": {"agent_id": "endpoint_id", "devicestatus": "endpoint_status", "agent_hostname": "endpoint_name", "action_local_ip": "ip_address", "assignmentgroup": "group_names"}, "execution_mode": "SCHEDULED", "search_window": "1 hours", "simple_schedule": "30 minutes", "timezone": "Asia/Singapore", "crontab": "*/30 * * * *", "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "dataset = endpoints\r\n| filter group_names in (\"NUCs\") and last_upgrade_status = \"COMPLETED_SUCCESSFULLY\" and endpoint_status = ENUM.CONNECTED  \r\n| alter ct = current_time()\r\n| alter diff_in_mins = timestamp_diff(ct, last_upgrade_status_time, \"MINUTE\")\r\n| filter diff_in_mins < 59\r\n| fields diff_in_mins, endpoint_status, endpoint_id, endpoint_name, group_names, agent_version, ip_address , mac_address, last_upgrade_status_time \r\n| sort desc diff_in_mins", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 13, "name": "Palo Alto Networks IoT Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = palo_alto_networks_iot_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 49, "name": "1000 eyes - uncleared alert", "severity": "User Defined", "xql_query": "dataset = cisco_1000_raw \r\n| filter alert_id != null\r\n| comp min(_time) as _time ,count() as c , values(eventId)as event_ids , values(cleared_time) as cleared_time, values(devices_names) as devices_names, values(details) as details by alert_id, testId, signature, test_type, test_name , alert_type, triggered_time, itsiDrilldownURI, vendor_severity addrawdata = true \r\n// | filter c = 1 and cleared_time = null\r\n| alter vendor_severity = if(vendor_severity = \"MINOR\", \"Low\", if(vendor_severity = \"CIRTICAL\", \"Critical\", vendor_severity ))\r\n| alter details = arraymerge(details )\r\n| alter devices_names = arraymerge(devices_names)", "is_enabled": true, "description": null, "alert_name": "1000 eyes - uncleared alert", "alert_category": "PERSISTENCE", "alert_type": null, "alert_description": "$details", "alert_domain": "DOMAIN_QA", "alert_fields": {"rulename": "test_name", "threadid": "testId", "signature": "signature", "policytype": "test_type", "agent_hostname": "devices_names", "originalalertid": "alert_id"}, "execution_mode": "SCHEDULED", "search_window": "20 minutes", "simple_schedule": "10 minutes", "timezone": "America/Chicago", "crontab": "*/10 * * * *", "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["alert_id", "alert_type", "test_name", "devices_names"], "dataset": "alerts", "user_defined_severity": "vendor_severity", "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 47, "name": "Health - Strong deviation in ingestion rate using Z score", "severity": "SEV_040_HIGH", "xql_query": "preset = metrics_view \r\n|filter last_seen > to_timestamp(1754146800000, \"MILLIS\") and timestamp_diff(current_time(), _time ,\"minute\") >= 6\r\n| alter unique_id = concat(_collector_id, _collector_ip, _collector_name, _collector_type, _collector_internal_ip_address, _final_reporting_device_ip, _final_reporting_device_name, _reporting_device_name, _collector_hostname, _broker_device_id, _device_id, _log_type, _vendor, _product)\r\n| alter t = _time \r\n| bin t span = 1h\r\n| comp sum(total_event_count) as total_event_count by unique_id, t\r\n| comp avg(total_event_count) as total_event_count_avg , var(total_event_count) as total_event_count_var by unique_id addrawdata = true as raw_stat //, _collector_id, _collector_ip, _collector_name, _collector_type , _final_reporting_device_ip ,_final_reporting_device_name , _broker_device_id ,_vendor , _product\r\n| join conflict_strategy = both  (\r\n    preset = metrics_view |filter timestamp_diff(current_time(), _time ,\"minute\") >= 6 and timestamp_diff(current_time(), _time ,\"minute\") <= 65 \r\n    | alter unique_id = concat(_collector_id, _collector_ip, _collector_name, _collector_type, _collector_internal_ip_address, _final_reporting_device_ip, _final_reporting_device_name, _reporting_device_name, _collector_hostname, _broker_device_id, _device_id, _log_type, _vendor, _product)\r\n    | alter t = _time \r\n    | bin t span = 1h\r\n    | comp sum(total_event_count) as total_event_count, values(_time) as v by unique_id, t addrawdata = true as jonined_raw\r\n       ) as last_ten_m last_ten_m.unique_id = unique_id \r\n| alter distance_to_average  =  subtract(total_event_count_avg, total_event_count)\r\n| alter total_event_count_std = pow(total_event_count_var, 0.5)\r\n| alter distance_to_average = if(distance_to_average <0 , multiply(distance_to_average , -1), distance_to_average )\r\n| alter anom = divide(distance_to_average ,total_event_count_std)\r\n| filter anom > 3\r\n\r\n\r\n", "is_enabled": true, "description": null, "alert_name": "Health - Strong deviation in ingestion rate using Z score", "alert_category": null, "alert_type": "Ingestion", "alert_description": null, "alert_domain": "DOMAIN_HEALTH", "alert_fields": {}, "execution_mode": "SCHEDULED", "search_window": "70 minutes", "simple_schedule": "1 hour", "timezone": "America/Chicago", "crontab": "0 * * * *", "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["unique_id"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 46, "name": "Health - Ingestion is absolute zero", "severity": "SEV_030_MEDIUM", "xql_query": "preset = metrics_view  \r\n|filter last_seen > to_timestamp(1754146800000, \"MILLIS\") //start of reg handoff - 0800,2-AUG\r\n| comp sum(total_event_count) as total_event_count_sum by _collector_id, _collector_ip, _collector_name, _collector_type, _collector_internal_ip_address, _final_reporting_device_ip, _final_reporting_device_name, _reporting_device_name, _collector_hostname, _broker_device_id, _device_id, _log_type, _vendor, _product\r\n| filter total_event_count_sum = 0\r\n\r\n\r\n", "is_enabled": false, "description": null, "alert_name": "Health - Ingestion is absolute zero", "alert_category": null, "alert_type": "Ingestion", "alert_description": null, "alert_domain": "DOMAIN_HEALTH", "alert_fields": {}, "execution_mode": "SCHEDULED", "search_window": "1 hours", "simple_schedule": "1 hour", "timezone": "America/Chicago", "crontab": "0 * * * *", "suppression_enabled": true, "suppression_duration": "1 days", "suppression_fields": ["_collector_id", "_collector_ip", "_collector_name", "_collector_type", "_collector_internal_ip_address", "_final_reporting_device_ip", "_final_reporting_device_name", "_reporting_device_name", "_collector_hostname", "_broker_device_id", "_device_id", "_log_type", "_vendor", "_product"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 52, "name": "Microsoft Teams Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = microsoft_teams_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 23, "name": "NGFW Vuln or Spyware trigger and allowed connections to reg_web", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n/*\n| fields app, from_zone, source_ip, source_port, dest_ip, dest_port, to_zone, action,\n    file_sha_256, sub_type,\n    dest_device_host,\n    cloud_hostname, log_source_name,\n    rule_matched,\n    severity,\n    pcap_id,\n    pcap,\n    session_id,\n    threat_name,\n    file_name, url_domain,\n    source_user_info_name,\n    threat_category, sub_type, threat_id, _reporting_device_ip, source_device_host, dest_device_host  */\n| alter threat = threat_name + \" (\" + to_string(threat_id) + \")\"\n| filter app not contains \"dns\"\n| filter lowercase(severity) != \"informational\" and lowercase(severity) != \"low\"\n| filter \n    threat_id != 40073     // PowerDNS Authoritative Server Long qname Denial-of-Service Vulnerability\n    and threat_id != 57955 // ZGrab Application Layer Scanner Detection\n// | filter incidr(dest_ip, \"10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16\") = false\n| filter to_zone = \"reg_web\"\n//| filter lowercase(rule_matched) != \"allow tap\"\n| filter lowercase(action) != \"reset-both\" and lowercase(action) != \"reset-server\" and lowercase(action) != \"reset-client\"\n| filter threat_name != \"Inline Cloud Analyzed CMD Injection Traffic Detection\" // the TAP was removed so we are excluding the inline C2 since it is allowed in", "is_enabled": true, "description": "NGFW Vuln or Spyware alert fired with severity >= medium AND action was not blocked/reset.", "alert_name": "NGFW Vuln or Spyware trigger and allowed connections to reg_web", "alert_category": "LATERAL_MOVEMENT", "alert_type": null, "alert_description": "Source IP $source_ip sent network traffic to reg_web zone, an NGFW vuln or spyware signature ($threat_id: $threat_name) with severity >= medium fired, and the action was not reset/block. This rule excludes TAP to avoid noise. This alert indicates a detected threat that may be an attack we did not prevent.", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"agent_hostname": "dest_device_host", "action_local_ip": "source_ip", "action_remote_ip": "dest_ip", "action_remote_port": "dest_port", "agent_device_domain": "url_domain", "actor_effective_username": "source_user_info_name", "actor_process_image_sha256": "file_sha_256"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 39, "name": "Corelight Suricata Alert", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = corelight_zeek_raw\n| fields _path, uid, id_orig_h as source_ip, id_resp_h as dest_ip, id_orig_p as source_port, id_resp_p as dest_port, id_resp_l2_addr as dest_mac, id_orig_l2_addr as source_mac, payload, payload_printable, alert_signature, alert_signature_id, alert_action, alert_category, alert_action, alert_metadata, alert_severity, alert_rule, service, enrichment_orig_network_name, enrichment_orig_network_ssid, enrichment_orig_room_name, enrichment_resp_network_name, enrichment_resp_network_ssid, enrichment_resp_room_name, conn_state, spcap_url, id_orig_chaddr\n| filter _path = \"suricata_corelight\" and ((payload != null and payload != \"\") or (payload_printable != null and payload_printable != \"\")) and (alert_metadata contains \"signature_severity:medium\" or alert_metadata contains \"signature_severity:high\" or alert_metadata contains \"signature_severity:critical\")\n", "is_enabled": true, "description": null, "alert_name": "Suricata Alert - $alert_signature", "alert_category": "User Defined", "alert_type": null, "alert_description": "$source_ip:$source_port to $dest_ip:$dest_port raised Suricata alert $alert_signature.\n\n$alert_rule", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"dstmac": "dest_mac", "srcmac": "source_mac", "payload": "payload", "action_local_ip": "source_ip", "suricatapayload": "payload_printable", "action_remote_ip": "dest_ip", "action_local_port": "source_port", "action_remote_port": "dest_port", "actor_effective_username": "source_mac"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": "alert_category", "mitre_defs": {}, "investigation_query_link": "config case_sensitive = false \n| dataset = corelight_zeek_raw \n| filter (`_path` = \"\"\"conn\"\"\")\n| fields uid  , id_orig_p , id_orig_chaddr , id_resp_l2_addr , id_orig_l2_addr , id, id_orig_h , id_resp_h , enrichment_orig_network_name, enrichment_orig_network_ssid, enrichment_orig_room_name, enrichment_resp_network_name, enrichment_resp_network_ssid, enrichment_resp_room_name, conn_state, spcap_url, id_orig_chaddr\n| join type = right (dataset = corelight_zeek_raw \n| filter (`_path` = \"\"\"yara_corelight\"\"\") | fields match_meta,match_rule,md5,mime_type,sha1,sha256,uid) as a a.uid=uid\n| join type = right (dataset = corelight_zeek_raw\n| fields _path, uid, id_orig_h as source_ip, id_resp_h as dest_ip, id_orig_p as source_port, id_resp_p as dest_port, id_resp_l2_addr as dest_mac, id_orig_l2_addr as source_mac, payload, payload_printable, alert_signature, alert_signature_id, alert_action, alert_category, alert_action, alert_metadata, alert_severity, alert_rule, service\n| filter _path = \"suricata_corelight\" and ((payload != null and payload != \"\") or (payload_printable != null and payload_printable != \"\")) and (alert_metadata contains \"signature_severity:medium\" or alert_metadata contains \"signature_severity:high\" or alert_metadata contains \"signature_severity:critical\")) as t t.uid = uid \n", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 25, "name": "NGFW Inline/ATP Alerts on TAP", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw | \nfields app, from_zone, source_ip, source_port, dest_ip, dest_port, to_zone, action,\n    file_sha_256, sub_type,\n    dest_device_host,\n    cloud_hostname, log_source_name,\n    rule_matched,\n    severity,\n    pcap_id,\n    pcap,\n    session_id,\n    threat_name,\n    file_name, url_domain,\n    source_user_info_name,\n    threat_category, sub_type, threat_id\n| alter threat = threat_name + \" (\" + to_string(threat_id) + \")\"\n// | filter incidr(dest_ip, \"10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16\") = false\n// | filter to_zone = \"reg_web\"                    // Irrelevant on TAP as the to_zone is TAP-FW-1\n| filter lowercase(rule_matched) = \"allow tap\"     // Inline C2 / ATP alerts are only enabled on TAP NGFWs\n| filter lowercase(threat_name) contains \"inline\"  // Inline C2\n// | filter lowercase(action) != \"reset-both\" and lowercase(action) != \"reset-server\" and lowercase(action) != \"reset-client\"", "is_enabled": false, "description": "Unblocked cloud-forwarded NGFW detections seen only on TAP. These are mainly of interest for threat hunting as they may or may not have a corresponding NGFW alert that is blocks.", "alert_name": "NGFW Inline/ATP Alerts on TAP", "alert_category": "LATERAL_MOVEMENT", "alert_type": null, "alert_description": "$source_ip alerted an Inline C2/ATP detection on TAP.", "alert_domain": "DOMAIN_HUNTING", "alert_fields": {"agent_hostname": "dest_device_host", "action_local_ip": "source_ip", "action_remote_ip": "dest_ip", "action_remote_port": "dest_port", "agent_device_domain": "url_domain", "actor_effective_username": "source_user_info_name", "actor_process_image_name": null, "actor_process_image_path": null, "actor_process_command_line": "file_name", "actor_process_image_sha256": "file_sha_256"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["source_ip"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 11, "name": "Panorama Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = panorama_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 16, "name": "RedLock Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = redlock_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 17, "name": "PrismaCloud v2 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = prismacloud_v2_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 38, "name": "Proofpoint TAP v2 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = proofpoint_tap_v2_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 48, "name": "Create alert for new/unassigned IT incidents", "severity": "SEV_050_CRITICAL", "xql_query": "dataset = incidents \n| filter incident_domain = \"DOMAIN_IT\"\n| filter status = ENUM.NEW", "is_enabled": true, "description": null, "alert_name": "Unassigned IT Incident", "alert_category": "OTHER", "alert_type": null, "alert_description": "Incident $name is unassigned. Incident ID: $incident_id\nIncident URI: https://bh.xdr.us.paloaltonetworks.com/incidents/overview?caseId=$incident_id", "alert_domain": "DOMAIN_QA", "alert_fields": {}, "execution_mode": "SCHEDULED", "search_window": "15 minutes", "simple_schedule": "10 minutes", "timezone": "America/Los_Angeles", "crontab": "*/10 * * * *", "suppression_enabled": true, "suppression_duration": "15 minutes", "suppression_fields": ["incident_id"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 10, "name": "Malleable C2 Attacks Inet Bourne", "severity": "SEV_050_CRITICAL", "xql_query": "dataset = panw_ngfw_threat_raw  \n| filter (threat_id = 9950 or threat_id = 89951 or threat_id = 89952 or threat_id = 89953 or threat_id = 89954 or threat_id = 89955 or threat_id = 89956 or threat_id = 89957 or threat_id = 89958 or threat_id = 99951 or threat_id = 99950 )  and ( from_zone  = \"Internet\" or to_zone  = \"Internet\")", "is_enabled": false, "description": null, "alert_name": "Malleable C2 Attacks Inet Bourne", "alert_category": "OTHER", "alert_type": null, "alert_description": "Type: subtype and Rule: $rule_matched\nThreat $threat_name on  Reg Server $dest_ip\nCharacteristic: $app_category", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"fw_app_id": "app", "action_local_ip": "source_ip", "fw_app_category": "app_category", "action_remote_ip": "dest_ip", "action_remote_port": "dest_port", "fw_app_subcategory": "app_sub_category"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "dataset = pan_ngfw_raw \n| filter (threatid = \"89950\" or threatid = \"89951\" or threatid = \"89952\" or threatid = \"89953\" or threatid = \"89954\" or threatid = \"89955\" or threatid = \"89956\" or threatid = \"89957\" or threatid = \"89958\" or threatid = \"99951\" or threatid = \"99950\" ) and ( From = \"Internet\" or To = \"Internet\")", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 6, "name": "Arista Wireless", "severity": "SEV_020_LOW", "xql_query": "config case_sensitive = false \n| dataset = arista_cloudvision_raw \n| alter client_mac = json_extract(radio, \"$.macaddress\")\n| alter client_mac = replace(client_mac,\"\\\"\",\"\")\n| alter userName = replace(userName, \"--\",\"\")\n| filter active = true", "is_enabled": false, "description": null, "alert_name": "Arista Wireless", "alert_category": "OTHER", "alert_type": null, "alert_description": "Arista Data", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"mac": "client_mac", "agent_hostname": "name", "action_local_ip": "ipAddress", "actor_effective_username": "userName"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": true, "suppression_duration": "1 minutes", "suppression_fields": ["client_mac", "name", "vendorName"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 7, "name": "Arista Wireless Misbehaving", "severity": "SEV_020_LOW", "xql_query": "config case_sensitive = false \n| dataset = arista_cloudvision_raw \n| alter client_mac = json_extract(radio, \"$.macaddress\")\n| alter client_mac = replace(client_mac,\"\\\"\",\"\")\n| alter userName = replace(userName, \"--\",\"\")\n| filter active = true and misbehaving = \"YES\"", "is_enabled": false, "description": null, "alert_name": "Arista Wireless Misbehaving", "alert_category": "OTHER", "alert_type": null, "alert_description": null, "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"mac": "client_mac", "agent_hostname": "name", "action_local_ip": "ipAddress", "actor_effective_username": "userName"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 9, "name": "Reg Servers Critical", "severity": "SEV_050_CRITICAL", "xql_query": "config case_sensitive = false \n| dataset = panw_ngfw_threat_raw \n| filter ((dest_ip = \"66.77.37.5\") or (source_ip = \"66.77.37.5\") or (dest_ip = \"10.220.153.11\") or (source_ip = \"10.220.153.11\")) and (severity != \"informational\") and (severity != \"low\" and rule_matched = \"Registration Web Server\")", "is_enabled": false, "description": null, "alert_name": "Reg Servers Critical", "alert_category": "OTHER", "alert_type": null, "alert_description": "Type: subtype and Rule: $rule\nThreat $threat_name on  Reg Server $dst\nCharacteristic: $characteristic_of_app", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"fw_app_id": "app", "action_local_ip": "source_ip", "action_remote_ip": "dest_ip", "action_remote_port": "dest_port"}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 55, "name": "ServiceNow Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = servicenow_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 42, "name": "ServiceNow v2 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = servicenow_v2_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 54, "name": "SlackV3 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = slackv3_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 3, "name": "Palo Alto Networks Threat Vault v2 Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = palo_alto_networks_threat_vault_v2_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 58, "name": "Twinwave Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = twinwave_generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": null, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}, {"rule_id": 34, "name": "Spike DNS Malware Traffic", "severity": "SEV_030_MEDIUM", "xql_query": "dataset = panw_ngfw_threat_raw \n\n|filter sub_type = \"spyware\"\n|filter threat_category ~= \"dns-malware\" \n\n\n| fields _time,_id,users as user,threat_category,threat_name as threat,\n    file_name as url_filename, app,tunneled_app, rule_matched as rule,\nto_zone, from_zone,\n    source_ip as src_ip,\n    source_port as src_port,protocol,\n    dest_ip, dest_port,\n    action,\n    dest_device_host as dest_hostname,\n    cloud_hostname, log_source_name as firewall_name,\n    severity,\n    pcap_id as pcap_id,\n    pcap,\n    session_id,\n    customer_id\n\n//Counting activity by 24h\n|bin _time span = 1d //count \n|comp count() as event_count , values(rule ) as rule , values(app) as app,values(tunneled_app) as tunneled_app, values(threat_category) as threat_category, values(url_filename ) as url_filename, values(from_zone) as from_zone, values(src_ip )as src_ip,values(src_port) as src_port, values(dest_port) as dest_port, values(protocol)as protocol, values(to_zone) as to_zone, values(dest_ip ) as dest_ip, values(action) as action, values(firewall_name) as log_source_name,values(pcap) as pcap,values(dest_hostname) as dest_device_host,values(cloud_hostname) as cloud_hostname,values(severity) as severity,values(pcap_id) as pcap_id,values(session_id) as session_id by user,threat,_time\n|filter if((url_filename  ~= \".*epicunitscan.info.*\" and event_count >= 300) or (event_count >= 100 and url_filename  !~= \".*epicunitscan.info.*\"), \"True\", \"False\") = \"True\" \n|sort desc event_count \n\n\n", "is_enabled": true, "description": "$user has $event_count (Spike) outbound traffic attempts to this malicious domain $url_filename ($threat) in the last 24 hours", "alert_name": "Spike DNS Malware Traffic", "alert_category": "EXFILTRATION", "alert_type": null, "alert_description": "$user has $event_count (Spike) outbound traffic attempts to this malicious domain $url_filename ($threat) in the last 24 hours.", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {"action_local_ip": "src_ip", "action_remote_ip": "dest_ip", "action_local_port": "src_port", "action_remote_port": "dest_port", "action_external_hostname": "url_filename", "actor_effective_username": "user"}, "execution_mode": "SCHEDULED", "search_window": "7 days", "simple_schedule": "1 hour", "timezone": "America/Los_Angeles", "crontab": "0 * * * *", "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["user", "threat", "threat_category", "url_filename"], "dataset": "alerts", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": {}, "investigation_query_link": "dataset = corelight_ndr_raw \n| filter id_orig_h = \"$src_ip\" and id_resp_h = \"$dest_ip\"\n\n| view column order = populated ", "drilldown_query_timeframe": "ALERT", "mapping_strategy": "CUSTOM", "action": "ALERTS", "lookup_mapping": []}, {"rule_id": 35, "name": "Testing Suricata", "severity": null, "xql_query": "dataset = corelight_zeek_raw  \n| filter _path = \"suricata_corelight\" \n| fields alert_category, id_orig_h , id_resp_h, alert_rule , alert_metadata   \n//| comp count() as t by id_orig_h addrawdata = true ", "is_enabled": false, "description": null, "alert_name": null, "alert_category": null, "alert_type": null, "alert_description": null, "alert_domain": null, "alert_fields": null, "execution_mode": "SCHEDULED", "search_window": "1 hours", "simple_schedule": "10 minutes", "timezone": "Europe/London", "crontab": "*/10 * * * *", "suppression_enabled": true, "suppression_duration": "1 hours", "suppression_fields": ["id_orig_h", "id_resp_h"], "dataset": "suricata_test", "user_defined_severity": null, "user_defined_category": null, "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": null, "mapping_strategy": "CUSTOM", "action": "DATASET", "lookup_mapping": []}, {"rule_id": 1, "name": "VirusTotal - Premium (API v3) Alerts (automatically generated)", "severity": "User Defined", "xql_query": "dataset = virustotal_premium_api_v3__generic_alert_raw\n| filter _alert_data != null\n| alter alert_severity = json_extract_scalar(_alert_data, \"$.severity\")\n| alter alert_category = json_extract_scalar(_alert_data, \"$.alert_category\")\n| alter alert_name = json_extract_scalar(_alert_data, \"$.alert_name\")\n| alter alert_description = json_extract_scalar(_alert_data, \"$.alert_description\")", "is_enabled": true, "description": null, "alert_name": "$alert_name", "alert_category": "User Defined", "alert_type": null, "alert_description": "$alert_description", "alert_domain": "DOMAIN_SECURITY", "alert_fields": {}, "execution_mode": "REAL_TIME", "search_window": null, "simple_schedule": null, "timezone": null, "crontab": null, "suppression_enabled": false, "suppression_duration": null, "suppression_fields": null, "dataset": "alerts", "user_defined_severity": "alert_severity", "user_defined_category": "alert_category", "mitre_defs": null, "investigation_query_link": null, "drilldown_query_timeframe": "ALERT", "mapping_strategy": "AUTO", "action": "ALERTS", "lookup_mapping": null}]